<main>
  <h1>{{ noticiaId ? 'Editar noticia ' : 'Añadir nueva noticia' }}</h1>

  <form [formGroup]="noticiaFields" (submit)="onSubmit(); noticiaFields.reset()">
    <div class="field-container">
      <input
        placeholder="Escribe un título"
        class="form-field"
        type="text"
        id="title"
        formControlName="title"
      />
      <app-error-message [formFields]="noticiaFields" control="title"></app-error-message>
    </div>
    @if (adminCategories.categories()) {
    <p>Selecciona una categoría o añade una nueva</p>
    } @else {
    <p>No hay ninguna categoría creada todavía. Añade una nueva categoría.</p>
    }
    <div class="category-fields">
      <select class="form-field" formControlName="existingCategory" id="existingCategory">
        <option value="General">General</option>
        @for(category of adminCategories.categories(); track $index) {
        <option [value]="category.category">{{ category.category }}</option>
        }
      </select>
      <input
        placeholder="Escribe una nueva categoría"
        class="form-field"
        type="text"
        id="newCategory"
        formControlName="newCategory"
      />
    </div>

    <editor formControlName="text" id="text" [init]="init"></editor>
    @if(noticiaFields.get('text')?.value?.includes('PwC')){
    <p>Tu texto contiene la palabra "PwC". Revísalo antes de publicar la noticia.</p>
    }

    <button class="button" type="submit" [disabled]="noticiaFields.invalid">
      {{ noticiaId ? 'Guardar' : 'Publicar' }}
    </button>
  </form>
</main>
